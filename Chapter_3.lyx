#LyX 1.6.7 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass article
\begin_preamble
\numberwithin{figure}{section}
\numberwithin{table}{section}
\end_preamble
\use_default_options true
\language english
\inputencoding auto
\font_roman palatino
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\paperfontsize 12
\spacing onehalf
\use_hyperref false
\papersize a4paper
\use_geometry true
\use_amsmath 1
\use_esint 1
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\leftmargin 20page%
\topmargin 15page%
\rightmargin 15page%
\bottommargin 15page%
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Section
Euler Delta Crossings Propagation
\begin_inset CommandInset label
LatexCommand label
name "sec:Euler-Delta-Crossings"

\end_inset


\end_layout

\begin_layout Subsection
Overview
\end_layout

\begin_layout Standard
Tractography methods provide tools to resolve major neuronal fibre bundles
 non-invasively and in-vivo 
\begin_inset CommandInset citation
LatexCommand cite
key "Catani2002NeuroImage"

\end_inset

.
 From the development of the first tractography algorithms 
\begin_inset CommandInset citation
LatexCommand cite
key "MCC+99,CLC+99"

\end_inset

 p nearly 
\begin_inset Formula $12$
\end_inset

 years ago a great number methods have been published.
 Most of these algorithms depend strictly on the underlying voxel model
 or acquisition paradigm making it difficult for other researchers to apply
 their own reconstruciton methods and evaluate their data sets.
\end_layout

\begin_layout Standard
In this work we designed a purely deterministic method which is fast, accurate
 and all-inclusive.
 But most importantly it can have as input model-based or model-free reconstruct
ion algorithms of most known algorithms.
 We call this algorithm EuDX.
 Eu stands for Euler integration, D stands for Delta function which is a
 function that checks for many different stopping criteria and X stands
 for fibre crossings.
 EuDX can deal with any number of crossing fibres as long as the reconstruction
 algorithm supports them.
 The purpose of this algorithm is to be faithful to the reconstruction results
 rather than try to correct or enhance them by introducing regional or global
 considerations which is the topic of other methods reviewed below.
 Therefore, EuDX serves mainly as a robust method for quickly inspecting
 different reconstruction results using streamlines.
 EuDX is noise-friendly i.e.
 if a voxel is too noisy then EuDX will stop tracking on that voxel.
 This property is often useful when validating underlying reconstruction
 models.
 Branching is also supported by a combination of trilinear interpolation
 and propagation along multiple peaks per voxel.
 This method is an extension of the method used by Conturo et al.
\begin_inset CommandInset citation
LatexCommand cite
key "CLC+99"

\end_inset

 and Yeh et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Yeh2010"

\end_inset

 with the additional support for multiple fibre-crossings.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Small techical details in tractography propagation algorithm can create
 very different results.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Tractography"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Known-problems"

\end_inset

 we discussed some of the ideas and the problems behind the most popular
 propagation methods; deterministic and probabilistic.
 The focus in this section will be to give a more general overview and introduce
 many more methods.
\end_layout

\begin_layout Standard
Most tractography techniques can be grouped in three categories, as pointed
 out in Sotiropoulos thesis 
\begin_inset CommandInset citation
LatexCommand cite
key "sotiropoulos2010processing"

\end_inset

; local, global and simulated.
 Local approaches propagate a curve from a starting (seed) point using locally
 greedy criteria, i.e.
 tracking sequentially through orientation estimates in adjacent voxels.
 Global approaches identify the best path between two points of interest,
 according to some optimization criterion, rather than identifying paths
 arising from a single point.
 Simulated approaches comprise of algorithms that simulate the diffusion
 process or solve the diffusion equation to reconstruct white matter tracks.
 A detailed literature review is given below.
\end_layout

\begin_layout Subsubsection
Local
\end_layout

\begin_layout Standard

\series bold
Deterministic 
\series default
tractography was the first to appear.
 Tracks (also known as streamlines) are created as trajectories in the form
 of polylines; orthograde and retrograde along an initial direction at a
 specific point (seed) in the 3D volume.
 In FACT
\begin_inset CommandInset citation
LatexCommand cite
key "MCC+99"

\end_inset

 tracks are propagated in anequal steps governed by the entry point of the
 streamline in the voxel (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:FACTvsEuDX"

\end_inset

).
 Euler integration with equal steps was used in Conturo et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "CLC+99"

\end_inset

 and similarly Runge-Kutta integration was used in Basser et al.
\begin_inset CommandInset citation
LatexCommand cite
key "BPP+00"

\end_inset

.
 Deterministic approaches usually stop propagating when a low anisotropy
 region (usually FA < 
\begin_inset Formula $0.2$
\end_inset

) is found.
 This is useful in order to avoid propagation within CSF where anatomical
 tracts do not exist or within deep gray matter regions where tracking is
 uncertain.
 They usually check also for large angle changes (e.g.
 larger than 
\begin_inset Formula $90{}^{\circ}$
\end_inset

) between successive steps to avoid unrealistically sharp turns.
 
\end_layout

\begin_layout Standard
Deterministic methods can be also utilized when multiple orientations are
 estimated in a single voxel (crossing fibres).
 These orientations can be obtained for example as the principal eigenvectors
 of multiple Tensors fitted to the data 
\begin_inset CommandInset citation
LatexCommand cite
key "Tuch2002ThesisMIT"

\end_inset

, or from the local peaks of the diffusion ODF estimated using DSI 
\begin_inset CommandInset citation
LatexCommand cite
key "wedeen2005mapping"

\end_inset

 and QBI 
\begin_inset CommandInset citation
LatexCommand cite
key "Tuch2004"

\end_inset

 or from the orientations from the fibre ODFs 
\begin_inset CommandInset citation
LatexCommand cite
key "tournier2004direct"

\end_inset

.
 There are different approaches for probagating across voxels with more
 than one fibre directions.
 On approach is, upon entering a voxel, to choose the orientation that produces
 the smallest curvature with the incoming path 
\begin_inset CommandInset citation
LatexCommand cite
key "WWS+08"

\end_inset

.
 Another approach follows all orientations that do not exceed a curvature
 threshold, by initiating a new streamline per orientation 
\begin_inset CommandInset citation
LatexCommand cite
key "chao2008multiple"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "Descoteaux2009"

\end_inset

.
 
\end_layout

\begin_layout Standard
Another interesting point is that most methods which belong in this category
 utilize only the fibre orientation estimates.
 Tensor deflection tractography (TEND) proposed by 
\lang british
Lazar et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "LWT+03"

\end_inset


\lang english
 is a FACT variant that uses the whole DTI Tensor rather than just its principal
 eigenvector to determine the direction of curve propagation.
 All the methods presented up to this point provide binary connectivity
 information i.e.
 a voxel B can be either connected or not connected to the seed S, depending
 on whether a streamline from S passes through B.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Streamline tractography utilizes only the fibre orientation estimates.
 In general, more information is available upon post-processing ofDWimages.
 For example, with DTI a diffusion tensor is computed.
 For perfectly spherical tensors the deflection angle is zero, while for
 oblate tensors, the deflection is towards the ellip- soid plane.
 Tensor deflection tractography is less sensitive to noise than streamline,
 as shown in simulations for straight tracts (Lazar et al., 2003).
 It can also propagate through regions of perpendicular fibre crossings,
 where the principal eigenvector of the underlying oblate Tensor is meaningless.
 However, Tensor deflection underestimates curvature for curved tracts.
 Furthermore, TEND results should be interpreted carefully, as an incoming
 direction that coincides with any of the Tensor eigenvectors will not be
 deflected by that Tensor; even if it is perpendicular to the principal
 eigenvector of a highly prolate Tensor (Lazar et al., 2003).
 All the methods presented in this section are deterministic and provide
 binary connectivity information.
 A voxel B can be either connected or not connected to the seed S, depending
 on whether a streamline from S passes through B.
 To tackle this issue, a group of probabilistic tractography approaches
 have been developed and these are presented in the following section.
\end_layout

\end_inset


\lang british
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout

\lang british
Other deterministic approaches can be found here A recent deterministic
 algorithm called Tensorlines
\begin_inset CommandInset citation
LatexCommand cite
key "weinstein1999tad"

\end_inset

 shares the problems of the other deterministic algorithms by failing in
 relatively sharp turns and Meyer's Loop.
 Furthermore, because these methods need a continuous field this necessitates
 the use of interpolation e.g.
 nearest, bicubic or trilinear.
 The amount and type of interpolation is another factor that can change
 dramatically the results of tractography and it is very rarely reported.
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
Probabilistic
\series default
 tractography was introduced by Parker et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Parker2003"

\end_inset

 and Behrens et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Behrens2003MRM"

\end_inset

.
 Here the standard procedure is to calculate a spatial distribution of tracks
 arising from a single seed rather than a single track.
 In each propagation step of each streamline, a random perturbation of the
 underlying fibre orientation estimate is followed.
 Perturbations are generated using functions that characterize the uncertainty
 in the fibre orientation within each voxel.
 A probabilistic index of connectivity (PICo) is defined between a seed
 and an arbitrary point as 
\begin_inset Formula $M/N$
\end_inset

 ; where 
\begin_inset Formula $N$
\end_inset

 is the number of all the tracks that start from the seed and 
\begin_inset Formula $M$
\end_inset

 is the number of tracks that traverse the seed and the arbitrary point.
\end_layout

\begin_layout Standard
Probabilistic approaches mainly differ in the way the orientation uncertainty
 is assessed.
 Most commonly a Bayesian framework will be used to calculate the posterior
 probability of the reconstruction model's orientation parameters 
\begin_inset CommandInset citation
LatexCommand cite
key "Behrens2003MRM"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "Behrens2007NeuroImage"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "hosey2005inference"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "friman2006bayesian"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "zhang2009probabilistic"

\end_inset

.
 In Behrens et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Behrens2003MRM"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "Behrens2007NeuroImage"

\end_inset

 Monte Carlo-Markov chain (MCMC) was used to sample the orientation posterior
 distribution.
 In Friman et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "friman2006bayesian"

\end_inset

 the posterior is computed numerically after using Dirac priors.
 In Zhange et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "zhang2009probabilistic"

\end_inset

 particle filtering was used for the same purpose.
\end_layout

\begin_layout Standard

\series bold
Bootstrap
\series default
 tractography is an alternative method to characterize uncertainty in fibre
 orientation 
\begin_inset CommandInset citation
LatexCommand cite
key "pajevic2003parametric"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "lazar2005bootstrap"

\end_inset

.
 This is an non-parametric approach where a diffusion acquisition is repeated
 many times for the same subject and some images from this set are drawn
 in random with replacement.
 This process gives a single bootstrap sample.
 Drawing many samples will give a distribution for the fibre orientation.
 The advantage of bootstrap tractography is that no ad-hoc assumptions are
 made on the noise and it is sensitive to all sources of variability that
 affect the acquired dataset.
 The disadvantage is that many repeated acquisitions are required; at least
 
\begin_inset Formula $5$
\end_inset

 for DTI according tohe disadvantage is that many repeated acquisitions
 are required according to O'Gorman et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "o2006just"

\end_inset

.
 
\end_layout

\begin_layout Standard
Model-based residual bootstrap offers an alternative, since it requires
 only a single data acquisition (Chung et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "chung2006comparison"

\end_inset

, Berman et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "berman2008probabilistic"

\end_inset

; Haroon et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "haroon2009using"

\end_inset

; Jones et al.,  
\begin_inset CommandInset citation
LatexCommand cite
key "jones2008tractography"

\end_inset

).
 A single bootstrap sample can then be generated by permuting freely the
 residuals (or just the sings of the residuals using wild boostrap Jones
 et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "jones2008tractography"

\end_inset

; Whitcher et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "whitcher2008using"

\end_inset

) between all model predicted values.
 The bootstrap technique was first introduced by Efron 
\begin_inset CommandInset citation
LatexCommand cite
key "efron1979bootstrap"

\end_inset

 in 
\begin_inset Formula $1979$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Other probabilistic
\emph on
 
\series default
\emph default
approaches estimate the orientation uncertainty as an empeiricaly defined
 function.
 For example in Parker et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Parker2003"

\end_inset

 this is determined using the degree of FA.
 The higher the FA the higher the confidence on the principal eigenvector
 of the Tensor.
 In Parker and Alexander 
\begin_inset CommandInset citation
LatexCommand cite
key "parker2003probabilistic"

\end_inset

 Monte-Carlo simulations are used to predict the orientation uncertainty
 for multiple Tensors and later in 
\begin_inset CommandInset citation
LatexCommand cite
key "parker2005probabilistic"

\end_inset

 for PAS.
 In Descoteaux et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "descoteaux2009deterministic"

\end_inset

 the fODF was used for the same purpose.
 Cook et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "cook2004modelling"

\end_inset

 used a Watson distribution and Seunarine et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "seunarine2007exploiting"

\end_inset

 used a Bingham distribution.
 In the same category we can also classify the work of Bjornemo et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "bjornemoMICCAI02"

\end_inset

 from 
\begin_inset Formula $2002$
\end_inset

 who created a regularized stochastic method for probabilistic tractography.
 This method utilizes the principles of a statistical Monte Carlo method
 called Sequential Importance Sampling and Resampling (SISR).
 This technique is similar with particle filters.
 The disadvantage of the method is that it has strong assumptions for the
 single Tensor as the reconstruction model.
\end_layout

\begin_layout Subsubsection
Global
\end_layout

\begin_layout Standard
A limitation of probabilistic tractography is that the probabilistic index
 of connectivity decreases with distance from the seed point (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Tractography"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Known-problems"

\end_inset

).
 Another limitation is that it is still sensitive to local noise.
 Global approaches try to overcome these limitations by being distance-independe
nt and by increasing resistance against noise.
 These are achieved by finding an optimal path between two voxels, according
 to a global property (see 
\begin_inset CommandInset citation
LatexCommand cite
key "DiffMRIBook"

\end_inset

).
\end_layout

\begin_layout Standard
Jbabdi et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "jbabdi2007bayesian"

\end_inset

 developed a 
\series bold
Global Bayesian
\series default
 model to derive the posterior probability of connections.
 The path trajectories represented by splines are compatible with the local
 fibre orientations in regions with low uncertainty estimates.
 In regions with high uncertainty, the global connectivity information constrain
s the local parameter estimation and affects the path sampling.
\end_layout

\begin_layout Standard

\series bold
Front evolution 
\series default
techniques often employ fast marching techniques.
 The front expands from the seed neighbours to the next neighbouring nodes
 with speeds determined by the local fibre orientations.
 As the front propagates, a time of front arrival can be associated with
 each visited voxel.
 Once all image voxels have been traversed by the front, paths of connection
 can be obtained going backwards in the map of front arrival times.
 Starting from an arbitrary voxel, a gradient descent algorithm can find
 the fastest route back to the seed.
 A connectivity index can be associated with each path, representing either
 the weakest link along the path or the agreement between the path tangents
 and the underlying vector orientation field (see Parker et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "parker2002estimating"

\end_inset

, Tournier et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "tournier2003diffusion"

\end_inset

, Cambell et al.
\begin_inset CommandInset citation
LatexCommand cite
key "campbell2005flow"

\end_inset

, Fletcher et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "fletcher2007volumetric"

\end_inset

 and Gigandet et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "gigandet2009global"

\end_inset

).
\end_layout

\begin_layout Standard

\series bold
Graph-based 
\series default
tractography utilises weighted networks (graphs).
 This type of tractography was presented by Iturria-Medina et al.
\begin_inset CommandInset citation
LatexCommand cite
key "IturriaMedina2007NeuroImage"

\end_inset

, Zalesky et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "zalesky2008dt"

\end_inset

, Lifshits et al.
\begin_inset CommandInset citation
LatexCommand cite
key "lifshits2009combinatorial"

\end_inset

, Fillard et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Fillard2009a"

\end_inset

 and Sotiropoulos et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "sotiropoulos2010brain"

\end_inset

.
 The common concept of these approaches is that each image voxel becomes
 a node in the graph where the edges of the graph connect pairs of neighbouring
 voxels or ROIs.
 The edges are assigned weights, that can be representative of any type
 of structural information.
 Anatomical paths are then defined as chains with successive elements being
 neighbouring voxels.
 The weights of the edges are used to determine the path strength.
 The strongest path between any image voxel and a seed can then be identified
 using algorithms that search efficiently the image graph.
\end_layout

\begin_layout Standard

\series bold
Energy Minimization
\series default
 
\begin_inset CommandInset citation
LatexCommand cite
key "kreher2008gibbs"

\end_inset

 methods try to optimize all tracks from the whole brain volume simultaneously.
 Each tract is represented as a chain of cylinders, whose position and orientati
on can change.
 The method tries to find the set of cylinders that best approximate the
 underlying white matter bundles.
 This is achieved by minimizing the overall energy of all cylinders simultaneous
ly, mimicking natural phenomena e.g.
 the polymerization process which is a process of reacting monomer molecules
 together in a chemical reaction to form three-dimensional networks.
 Many standard algorithms e.g.
 gradient descent are usually employed with this framework; however Gibbs
 sampling is the most common in tractography.
 Kreher et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Kreher2008ISMRM"

\end_inset

, Reisert et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "reisert2010global"

\end_inset

, Lazar et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "lazar2002white"

\end_inset

 and Fillard et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Fillard2009"

\end_inset

 showed results using energy minimization.
 Despite the very promising results shown by Reisert et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "reisert2010global"

\end_inset

, whose team won the Fibre Cup competition
\begin_inset CommandInset citation
LatexCommand cite
key "fillard2011quantitative"

\end_inset

 the very high computation time is an important disadvantage of this framework.
\end_layout

\begin_layout Standard

\series bold
Microstructure Tracking 
\series default
is a very exciting new family of algorithms which started with MicroTrack
\begin_inset CommandInset citation
LatexCommand cite
key "sherbondy2010microtrack"

\end_inset

 that combine global tractography and direct microstructure estimation using
 diffusion-weighted imaging data.
 Connectivity via tractography, axon diameter distribution and density estimates
 are all combined in order to inform one another given the common assumption
 that microstructural features remain consistent along fibers.
 This type of algorithms need of course special data sets of acquisitions
 similar with those employed in ActiveAx invented by Alexander et al.
\begin_inset CommandInset citation
LatexCommand cite
key "alexander2010orientationally"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Simulated
\end_layout

\begin_layout Standard
This family of methods take a very different approach from what we have
 discussed until this moment.
 They simulate the diffusion of water molecules within the brain tissue
 or directly solve Fick’s second law of diffusion in the entire brain (see
 
\begin_inset CommandInset citation
LatexCommand cite
key "batchelor2001study"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "kang2005white"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "hageman2009diffusion"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "hagmann2003dti"

\end_inset

).
\end_layout

\begin_layout Standard
In Batchelor et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "batchelor2001study"

\end_inset

, the diffusion equation is solved using a finite element approach.
 Successive diffusion simulations over the entire brain, starting froma
 seed, are performed in Kang et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "kang2005white"

\end_inset

.
 Tractography by simulating fluid flow through a 
\begin_inset Quotes eld
\end_inset

pressure
\begin_inset Quotes erd
\end_inset

 Tensor field is performed in Hageman et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "hageman2009diffusion"

\end_inset

.
 The Navier-Stokes equation is solved using a finite element approach.
 However, solving a partial differential equation increases execution time.
 Furthermore, it is not always easy with these approaches to obtain a connectivi
ty map across the whole brain volume and there is usually a large number
 of parameters to set.
 
\end_layout

\begin_layout Standard
For further understanding of the current map of all the different tractography
 algorithms see the reviews from 
\begin_inset CommandInset citation
LatexCommand cite
key "fillard2011quantitative"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "sotiropoulos2010processing"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Jbabdi2007"

\end_inset

.
 In Fillard et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "fillard2011quantitative"

\end_inset

 
\begin_inset Formula $10$
\end_inset

 tractographies were simulated using a novel hardware phantom.
 Comparing all these different methods which all have different parameters
 and are based on different underlying models is a difficult process and
 a ground truth from anatomical studies, digital or hardware phantoms is
 absolutely necessary.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
http://www.docstoc.com/docs/58019487/Diffusion-Tensor-MRI-at-3-Tesla
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Algorithm
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Decide if you need Then for the algorithms.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Itemize

\series bold
Input
\end_layout

\begin_layout Itemize
anisotropic volume metric
\end_layout

\begin_deeper
\begin_layout Itemize
unit directions 
\end_layout

\begin_layout Itemize
resampling sphere
\end_layout

\begin_layout Itemize
seeds
\end_layout

\begin_layout Itemize
anisotropy low threshold
\end_layout

\begin_layout Itemize
step size 
\end_layout

\begin_layout Itemize
angular threshold
\end_layout

\begin_layout Itemize
total_weighting threshold
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename EuDX_propagation.png
	lyxscale 30
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
In this diagram we see that in every voxel centre (black dot) there is one
 or more vectors.
 These vectors represent peaks where their length is equal to the anisotropy
 value and the direction is equal to the direction of the peak e.g.
 calculated in a given ODF.
 EuDX can track multiple peaks starting from a single seed point (star)
 if their anisotropy values are higher than a threshold.
 In order to reduce memory usage we discretize the directions using the
 vertices of a unit sphere.
 Then we only need to input to EuDX a 4D volume with anisotropy values 
\begin_inset Formula $\mathcal{A}$
\end_inset

 and a 4D volume 
\begin_inset Formula $\mathcal{I}$
\end_inset

 with the indices of the directions.
 The first three dimensions in 
\begin_inset Formula $\mathcal{A}$
\end_inset

 are for the voxel position and the last dimension is for the peak values
 (anisotropy).
 Respectively, the first three dimensions in 
\begin_inset Formula $\mathcal{I}$
\end_inset

 are for the voxel position and the last dimension contains the indices
 of the orientations (vertices) of the peaks sampled on a discrete sphere.
 In that way we can track from the same seed towards different directions
 and support tracking in crossing areas.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:EuDX_sketch"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We created an algorithm that has many similarities with the classical determinis
tic methods 
\begin_inset CommandInset citation
LatexCommand cite
key "MCC+99,CLC+99,BPP+00"

\end_inset

 and with more recent as those described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Descoteaux2009,Yeh2010"

\end_inset

.
 Our concentration was to create a more general streamline tractography
 propagation framework which can be used with very different families of
 anistropic functions and work well with fibre crossings.
 This algorithm that we call EuDX is applied usually in native space image
 coordinates and it assumes that the voxel dimensions are equal in all three
 dimensions (isotropic voxel size).
 In order to create streamlines (tracks) we need to provide initially one
 or more seed points 
\begin_inset Formula $S$
\end_inset

.
 These can be choosed randomly or we could specify them explicitly.
 However, these seed points need to be constrained by the volume's dimensions.
 Every seed point 
\begin_inset Formula $\mathbf{p}_{0}$
\end_inset

 becomes the starting point for the track propagation.
\end_layout

\begin_layout Standard
For the integration we solve for 
\begin_inset Formula $\mathbf{p}_{t}=\mathbf{p}_{0}+\int_{0}^{t}\mathbf{v}(p(\mathbf{s}))d\mathbf{s}$
\end_inset

 and we perform the integration numerically using Euler's method 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\mathbf{p}_{n+1}=\mathbf{p}_{n}+\mathbf{v}(\mathbf{p}_{n})\Delta s\label{eq: euler}\end{equation}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 where 
\begin_inset Formula $\Delta s$
\end_inset

 is the propagation step size which should be at least smaller than the
 voxel size, 
\begin_inset Formula $\mathbf{v}$
\end_inset

 is the propagation direction.
 Alternatively, Runge-Kutta of 
\begin_inset Formula $2$
\end_inset

nd and 
\begin_inset Formula $4$
\end_inset

th order can be used.
 However, in this document we used only Euler's method.
 For EuDX stopping criteria we can use a standard scalar function like FA
 but we can also use vector functions like Quantitative Anisotropy (QA)
 or even the full Orientation Density Function (ODF).
 The only constraint for these functions is to be greater or equal to zero
 everywhere in the volume.
 In most cases all these functions try to measure in some way the anisotropy
 of diffusion in every single voxel so we decided to use letter 
\begin_inset Formula $\mathcal{A}$
\end_inset

 for the purpose of representing all these fields applied on the image grid.
 Therefore, when we write 
\begin_inset Formula $\mathcal{A}(\mathbf{u}_{i})=\alpha_{i}$
\end_inset

 this reads for the peak unit direction of 
\begin_inset Formula $\mathbf{u}_{i}$
\end_inset

 the peak value was 
\begin_inset Formula $\alpha_{i}$
\end_inset

.
 For the simple case of FA, 
\begin_inset Formula $\mathbf{u}$
\end_inset

 is equal with the eigenvector corresponding to the highest eigenvalue,
 
\begin_inset Formula $\mathcal{A}(\mathbf{e})=FA$
\end_inset

.
 For QA which can allow even for up to 
\begin_inset Formula $5$
\end_inset

 peaks or more we use 
\begin_inset Formula $\mathcal{A}(\mathbf{u}_{i})=QA_{i}$
\end_inset

 where 
\begin_inset Formula $i\in[0,4]$
\end_inset

 denotes the current peak.
 The peak can be characterised by two things the anisotropy value 
\begin_inset Formula $\alpha_{i}$
\end_inset

 and the unit direction of the peak 
\begin_inset Formula $\mathbf{u}_{i}$
\end_inset

.
 A visual example of the combination of multiple peaks togehter with EuDX
 can be seen in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:EuDX_sketch"

\end_inset

.
\end_layout

\begin_layout Standard
The EuDX algorithm can be described further in the following way.
 
\begin_inset Formula $\mathcal{A}(\mathbf{u}_{i})$
\end_inset

 is estimated at every point of the volume.
 This resembles a composite vector field where every point contains the
 peak directions superimposed to the anisotropy values.
 In order to reduce space 
\begin_inset Formula $\mathbf{u}$
\end_inset

 can be replaced by an index to the closest sampling point of an evenly
 distributed sphere.
 We create an empty list of tracks 
\begin_inset Formula $T=\emptyset$
\end_inset

 and then we generate random or prespecified seed points 
\begin_inset Formula $\mathbf{p}_{0j}$
\end_inset

 for every track 
\begin_inset Formula $t_{j}$
\end_inset

.
\end_layout

\begin_layout Standard
We pick a seed point 
\begin_inset Formula $\mathbf{p}_{0}$
\end_inset

 and start propagating.
 We need to remember that the propagation direction can go forward and backward
 or better said; towards one direction (orthograde) and its opposite direction
 (retrograde).
 For the moment we only propagate towards one direction set by
\begin_inset Formula \begin{equation}
\mathbf{v}(\mathbf{p}_{0})=argmax_{u_{i}}\mathcal{A}(\mathbf{u})\label{eq:argmax_anisotropy}\end{equation}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 but we need to propagate also towards the opposite direction 
\begin_inset Formula $-\mathbf{v}(\mathbf{p}_{0})$
\end_inset

.
 Furthermore, as 
\begin_inset Formula $\mathcal{A}$
\end_inset

 can have multiple values in each voxel (representing different peaks) we
 need to remember that when we finish with this track followed by direction
 
\begin_inset Formula $\mathbf{v}$
\end_inset

 we will need to propagate towards the direction of second maximum, third
 maximum etc.
 This is necessary if and only if 
\begin_inset Formula $\mathcal{A}$
\end_inset

 gives information for multiple peaks (e.g.
 QA).
\end_layout

\begin_layout Standard
Apart from the direction we need to check when to stop tracking.
 EuDX takes as input a threshold for anisotropy 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

.
 If 
\begin_inset Formula $\mathcal{A}(\mathbf{p}_{n})<\mathcal{A}_{thr}$
\end_inset

 then EuDX stops propagating.
 Otherwise it appends the point to the current track 
\begin_inset Formula $t_{j}$
\end_inset

.
 This can be useful for cancelling out any seed points which are in the
 background or in very low anisotropy areas where tracking is not recommended.
 One important point here is that 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

 depends on the reconstruction method and it will have a different value
 for every different metric QA, FA, GFA etc.
 
\end_layout

\begin_layout Standard
In order to generate a smooth tractography it is recommended to use some
 kind of interpolation.
 Here we have been using trilinear interpolation which works in the following
 way.
 The seed devides the neibourhing area (constrained by the centers of the
 neighbouring voxels) in 
\begin_inset Formula $8$
\end_inset

 regions in 3D (it would be 
\begin_inset Formula $4$
\end_inset

 in 2D) and the total contribution of the neighbouring points is added according
 to the weights 
\begin_inset Formula $w$
\end_inset

 of the antipodal side.
 The weights express subvolumes in 3D (or subareas in 2D).
 The trilinear interpolation give us the weights 
\begin_inset Formula $w$
\end_inset

 that assign the contribution of the peaks of the neighbouring voxels to
 the seed's next direction.
\end_layout

\begin_layout Standard
We find the nearest direction from the seed's initial direction 
\begin_inset Formula $\mathbf{v}(\mathbf{p_{n}})$
\end_inset

 to every 
\begin_inset Formula $\mathbf{u}_{i}$
\end_inset

 of every one of the 
\begin_inset Formula $8$
\end_inset

 corners of the neighbourhood of the seed.
 
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\textnormal{arccos}(\mathbf{x}_{i},\mathbf{p}_{n})\leqq\theta_{thr}$
\end_inset

 we count the corresponding weight otherwise we continue to the next weight.
 We check simultaneously for the condition 
\begin_inset Formula $\mathcal{A}(\mathbf{u})<\mathcal{A}_{thr}$
\end_inset

.
 All the adjacent weights will contribute to the new direction according
 to the following formula
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\mathbf{v}^{'}(\mathbf{p}_{n})=\sum_{m}w_{m}\mathbf{v}(\mathbf{p}_{n})\label{eq:trilinear_weights}\end{equation}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 where 
\begin_inset Formula $\mathbf{v}(\mathbf{p}_{n})=\dfrac{\mathbf{v}^{'}(\mathbf{p}_{n})}{||\mathbf{v}^{'}(\mathbf{p}_{n})||}$
\end_inset

 is normalized.
 The next point is calculated with eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: euler"

\end_inset

.
 We insert the new point in the track and continue tracking until one of
 the stopping criteria is met.
 Finally, we have to repeat the procedure for the opposite direction of
 the initial 
\begin_inset Formula $\mathbf{v}(\mathbf{p}_{o})$
\end_inset

 and for the smaller peaks as in (2).
\end_layout

\begin_layout Standard
Many other thresholds apart from the anisotropic threshold 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

 and angular threshold 
\begin_inset Formula $\theta_{thr}$
\end_inset

 are also incorporated in EuDX.
 a) The total weight 
\begin_inset Formula $TW$
\end_inset

 check that there is enough overall neighbourhood weighting to continue
 tracking (has default value 
\begin_inset Formula $0.5$
\end_inset

).
 This is very useful in edges or corners where you want tracking to stop.
 b) It is possible for a track to get trapped in a loop and start looping
 for ever.
 We can check for that using a threshold for maximum number of points for
 a track 
\begin_inset Formula $MNP$
\end_inset

 (default 
\begin_inset Formula $1000$
\end_inset

).
 c) Also we need to check that we are always inside the 3D volumetric space.
 The dimensions of the volume are hold in vector 
\begin_inset Formula $V$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textbf{Input} $
\backslash
mathcal{A}$, $
\backslash
mathcal{I}$, $S$, $U$, $
\backslash
Delta s$, $VS$ 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2.5em} $
\backslash
mathcal{A}_{thr}$,$
\backslash
theta_{thr}$, $TW$, $MNP$ (thresholds) 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Output} $T$
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\begin_layout Plain Layout

$T=
\backslash
emptyset$
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Foreach} seed 
\backslash
textbf{In} $S$
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
textbf{Foreach} peak 
\backslash
textbf{In} ($
\backslash
mathcal{A}$, $
\backslash
mathcal{I}$) 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} t = EUDX
\backslash
_Core(seed,peak) 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} 
\backslash
textbf{Append}($T$,t) 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
caption{EuDX Tractography}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Alg:EuDX_Main"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In alg.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Alg:EuDX_Main"

\end_inset

 we see how EuDX can be called in order to create an entire tractography.
 The core algorithm which is the same for every seed is given in alg.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Alg:EuDX_Core"

\end_inset

.
 In alg.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Alg:EuDX_Main"

\end_inset

 the inputs are: 
\begin_inset Formula $\mathcal{A}$
\end_inset

 the 4D volume holding the strength of anisotropy in relation to the indexed
 directions of sphere 
\begin_inset Formula $U$
\end_inset

 given in 
\begin_inset Formula $\mathcal{I}$
\end_inset

.
 
\begin_inset Formula $U$
\end_inset

 is an array of size 
\begin_inset Formula $N\times3$
\end_inset

 where 
\begin_inset Formula $N$
\end_inset

 are is the number of vertices in the sphere.
 
\begin_inset Formula $S$
\end_inset

 is an 
\begin_inset Formula $M\times3$
\end_inset

 array with the precomputed 
\begin_inset Formula $M$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\lang british
 seed points (seeds).
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
\lang english

\begin_inset Formula $\Delta s$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\lang british
 is the propagation step.
 We also need the different stopping thresholds
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
\lang english
: 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

 defines the lowest possible anisotropy value that allows tracking to continue.
 
\begin_inset Formula $\theta_{thr}$
\end_inset

 is the maximum allowed angle between the current propagation direction
 and the next direction.
 
\begin_inset Formula $TW$
\end_inset

 checks the overall contribution of the neighbourhood for the next propagation
 direction and 
\begin_inset Formula $MNP$
\end_inset

 checks that a track does not pass from the same point more than a number
 of times.
 
\begin_inset Formula $MNP$
\end_inset

 checks this condition by counting the number of current points appended
 in a track as the track grows.
 
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textbf{Input} seed, peak, $
\backslash
Delta S$, $V$ thresholds 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Output} track  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\begin_layout Plain Layout

delta, i
\backslash
_direction = Initial
\backslash
_Direction(seed) 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
#propagate orthograde 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

direction=i
\backslash
_direction 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{While} delta 
\backslash
textbf{Is} True
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} delta, n
\backslash
_direction = New
\backslash
_Direction(direction)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
textbf{If} delta 
\backslash
textbf{Is} False
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} 
\backslash
textbf{Break} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} point = point + $
\backslash
Delta s$$
\backslash
times$n
\backslash
_direction 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
textbf{Append}(track,point)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} direction = n
\backslash
_direction 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

delta = True 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
#propagate retrograde 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

direction = - i
\backslash
_direction 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{While} delta 
\backslash
textbf{Is} True
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
#Same as above 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
caption{EuDX Core}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Alg:EuDX_Core"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The main corpus of EuDX is given in alg.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Alg:EuDX_Core"

\end_inset

.
 This is called for every seed and peak.
 The algorithm starts by calling the function Initial_Direction which finds
 the closest peak direction to follow from the nearby voxels and if the
 values of these peaks are lower than 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

 then it returns False otherwise it returns True and the vector with the
 initial direction.
 The variable delta is used as check point that no stopping criteria are
 met.
 As long as delta is True we can continue tracking.
 The function New_Direction calculates the new direction of the propagation
 by accumulating the weights created by trilinear interpolation as shown
 in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:trilinear_weights"

\end_inset

 and finds the nearest direction for the eight neighbouring voxels.
 It also checks for the total weight threshold 
\begin_inset Formula $TW$
\end_inset

 and if we are inside the volume's boundaries given by 
\begin_inset Formula $V$
\end_inset

.
 After this is done we update the points as shown in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: euler"

\end_inset

 and repeat the same procedure until one of the stopping criteria is met
 (by checking variable delta).
 Finally, we repeat the same for the retrograde direction in order to create
 the entire track.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Initial_Direction find the closest direction to follow if all A_thr are
 low then it returns False (Delta)
\end_layout

\begin_layout Plain Layout
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textbf{Input} seed, peak, $A$ 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Output} True/False, direction  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

point=Nearest
\backslash
_Interpolation(seed)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{If} $A$[point]< aniso
\backslash
_thr 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return False 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Else}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return True, direction
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
caption{EuDX Initial Direction}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Alg:EuDX Initial Direction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Calculates the weights for trilinear interpolation and finds nearest direction
 / check total_weight threshold (max total weight is 1- that a peak has
 enough weight so we are close at a peak and that all other peaks of the
 neighbourhood contribute.
\end_layout

\begin_layout Plain Layout
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textbf{Input} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Output} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

weights=Trilinear
\backslash
_Interpolation(seed)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{If} out of volue  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return False 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

total
\backslash
_weight=0 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Else}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return True, direction
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{For} 8 corners
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} Delta, direction = Nearest
\backslash
_Direction
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
textbf{If} Delta 
\backslash
textbf{is} False
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} 
\backslash
textbf{Continue}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} total
\backslash
_weight += W[corner]
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} new
\backslash
_direction += W[corner]$
\backslash
times$direction
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{If} total
\backslash
_weight < total
\backslash
_weight
\backslash
_thr
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} return False
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Else}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} return True, normalized(new
\backslash
_direction)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
caption{EuDX New Direction}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Alg:EuDX New Direction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Just compares and finds the current direction with the peak direction and
 gives back the neirest or False.
\end_layout

\begin_layout Plain Layout
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textbf{Input} seed, peak, $A$ 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Output} True/False, direction  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
textbf{If} maximum
\backslash
_peak < aniso
\backslash
_thr 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return False 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{For} all peaks 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} 
\backslash
textbf{If} peak < $A$
\backslash
_thr 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{4em} 
\backslash
textbf{Break}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} angle = angle(peak direction, current direction)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{If} maximum
\backslash
_angle > angle
\backslash
_thr 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
hspace*{2em} return False
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Else} return True, direction (closest peak - angular)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
caption{EuDX Nearest Direction}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Alg:EuDX Nearest Direction"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Results with digital phantoms
\end_layout

\begin_layout Standard
In order to validate the performance of EuDX we created a 3-dimensional
 digital phantom with the method described in section 2.8.2-XXX 
\begin_inset CommandInset citation
LatexCommand cite
key "canalesrodriguez2009mdq"

\end_inset

 with eigen values
\begin_inset Formula $\lambda_{\parallel}=1.7\cdot10^{-3}$
\end_inset

 
\lang british

\begin_inset Formula $m^{2}/sec$
\end_inset


\lang english
 and 
\begin_inset Formula $\lambda_{\perp}=.1\cdot10^{-3}m^{2}/sec$
\end_inset

.
 The digital phantom consists of two parts: a) a diagonal orbit and b) an
 elliptical orbit with ( with axes ratio
\begin_inset Formula $\text{\lambda}_{2}=0.6\lambda_{1})$
\end_inset

.
 Both parts were added together to create a crossing configuration and no
 partial volume effects were simulated.
 The average thickness of both parts was 
\begin_inset Formula $~5$
\end_inset

 voxels.
 The elliptical orbit did not complete a full ellipsis in order to avoid
 tracks from looping forever.
 We created two experiments using the same data set of size 
\begin_inset Formula $64\times64\times64\times102$
\end_inset

 where the 
\begin_inset Formula $3$
\end_inset

 first dimensions were giving the size of the volume and the last dimension
 is the number of diffusion weighted volumes (
\begin_inset Formula $101$
\end_inset

) plus the unweighted b0 volume (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:crossing_eudx_sims"

\end_inset

(i) lower right - jet colourmap).
 We generated b-vectors and b-values by using a keyhole Cartesian sampling
 grid
\begin_inset CommandInset citation
LatexCommand cite
key "Tuch2002ThesisMIT"

\end_inset

(see Fig.
 q-space Introduction 1.5 XXX); therefore, DSI, GQI, EIT or DTI were suitable
 for the signal reconstruction into orientation distributions or Tensors
 respectively.
 For both experiments we used a high SNR of 
\begin_inset Formula $100$
\end_inset

 as the main goal was to validate the algorithm on good conditions.
 We later continue the validation process with human data where SNR is naturally
 lower.
\end_layout

\begin_layout Standard
In the first experiment (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:crossing_eudx_sims"

\end_inset

) we generated 
\begin_inset Formula $200,000$
\end_inset

 uniformly random seeds in the 3D volume.
 We used DSI reconstruction with standard parameters: q-space grid size
 
\begin_inset Formula $16$
\end_inset

, hanning filter width 
\begin_inset Formula $32$
\end_inset

, and radial integration range from 
\begin_inset Formula $2.1$
\end_inset

 to 
\begin_inset Formula $6$
\end_inset

 at steps of 
\begin_inset Formula $.2$
\end_inset

.
 The input of EuDX expects the peaks and the directions of the peaks.
 For every voxel we used DSI to create the corresponding ODF (sampled on
 an evenly distributed sphere of 
\begin_inset Formula $642$
\end_inset

 vertices and 
\begin_inset Formula $1280$
\end_inset

 faces) and from the ODF we using the peak finding function introduced in
 Ch.
 2.6 XXX.
 We further removed the peaks which had values less that 
\begin_inset Formula $70\%$
\end_inset

 of the highest peak and normalized the rest so that the maximum peak equals
 to 
\begin_inset Formula $1$
\end_inset

.
 We also calculated FA and zeroed the peaks with FA values less than 
\begin_inset Formula $0.2$
\end_inset

.
 In that way we ensured that there will be no tracking in the background
 area of the phantom.
\end_layout

\begin_layout Standard
Finally, we called EuDX with parameters 
\begin_inset Formula $\mathcal{A}_{thr}=0.2$
\end_inset

,
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
Delta s=0.5$
\end_layout

\end_inset

, 
\begin_inset Formula $\theta_{thr}=60^{\circ}$
\end_inset

 and 
\begin_inset Formula $TW=0.5$
\end_inset

 and visualized the tracks.
 The results are shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:crossing_eudx_sims"

\end_inset

.
 The tracks are colourcoded with their orientation defined as the unit vector
 connecting the first with the last point of each track.
 Because we generated random seeds that went everywhere in the phantom some
 of them had to be in the crossing area.
 In accordance with what we discussed in the previous section we know that
 if a seed fall in a crossing region EuDX will propagate towards both directions
 of the crossing if and only if multiple peaks are supported from the underlying
 reconstruction method.
 We can confirm this by looking at fig
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:crossing_eudx_sims"

\end_inset

(i) and in (ii), (iii) in higher resolution; where we can see that the crossing
 area is well represented and that the propagation was successful.
 We can also observe that not all tracks travel all the distance from end
 to end.
 Otherwise you would except to see the tracks of the entire elliptic part
 all with one colour and the tracks of the straight orbit all with a second
 colour.
 It seems that this had to do with the discrete nature of the phantom especially
 near the boundaries of the phantom.
 Therefore, we created a different experiment to evaluate this observation.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename last_figures/crossing_eudx.png
	lyxscale 30
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Left panel shows the tractrography for a software phantom generated by EuDX
 with DSI as the reconstruction method.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:crossing_eudx_sims"

\end_inset


\end_layout

\end_inset

In the second experiment we generated 
\begin_inset Formula $2000$
\end_inset

 seeds inside specific areas (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:eudx_fromABCD"

\end_inset

-left panel).
 More precisely the end-point areas of the phantom denoted with A,B,C and
 D.
 The goal was to count the percentage of tracks which reached any of the
 other end-point areas.
 We tried this with 
\begin_inset Formula $4$
\end_inset

 different reconstruction methods: Single Tensor, EITL, DSI and GQI.
 The Single Tensor was fitted using weighted least squares.
 For EITL we used for radial sampling from 
\begin_inset Formula $0$
\end_inset

 to 
\begin_inset Formula $5$
\end_inset

 with steps of 
\begin_inset Formula $0.4$
\end_inset

 and gaussian weight of 
\begin_inset Formula $0.05$
\end_inset

.
 GQI had sampling length of 
\begin_inset Formula $1.2$
\end_inset

 and DSI had the same parameters as in the previous experiment.
 The orientations of the peaks for all the methods were found in a reconstructio
n sphere of 
\begin_inset Formula $642$
\end_inset

 vertices.
 The same peaking function was also used with the ODFs of EITL,GQI and DSI.
 For these 3 methods the peaking procedure was the same as described in
 the previous experiment.
 The single peak of the DTI reconstruction was found by the corresponding
 eigenvalues and eigenvectors.
 EuDX expects the orientation input of the peaks as indices on a unit sphere;
 therefore, for the eigenvector which corresponds to the maximum eigenvalue
 we found the vertex in the reconstruction sphere (used above) with the
 minimum angular distance.
 
\end_layout

\begin_layout Standard
The results of this study are summarized in tab.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Tab:EuDX_AtoB"

\end_inset

.
 A first general observation is that independently from which end-points
 the tracks start there will be always a percentage of tracks which will
 stop before reaching the other end-points.
 We can see clearly this phenomenon by looking at the last column (
\begin_inset Formula $\emptyset$
\end_inset

) of each sub-table; where the best case was 
\begin_inset Formula $3.7\%$
\end_inset

 loss (EITL) and and the worst case was 
\begin_inset Formula $43.5\%$
\end_inset

 (DTI).
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
small
\backslash
addtolength{
\backslash
tabcolsep}{-5pt}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DTI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\emptyset$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
76.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23.6%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
59.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40.2%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
79.9%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.1%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
56.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
43.5%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hspace{1.5em}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
EITL
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\emptyset$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
63.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.7%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27.9%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
65.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.8%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
76.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.7%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
95.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.7%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DSI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\emptyset$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
65.3%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25.1%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
72.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21.9%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
79.9%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6.1%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
84.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.6%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hspace{1.5em}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GQI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\emptyset$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
57.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.7%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
33.5%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
67.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.7%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22.1%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
37.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
55.5%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22.3%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
72.3%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

--
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.4%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Every sub-table shows the percentage of tracks which started from areas
 A,B,C or D (rows) and reached the other areas A,B,C,D or 
\begin_inset Formula $\emptyset$
\end_inset

 (columns) using EuDX with input from different reconstruction methods DTI,
 EITL, DSI, GQI.
 The empty set 
\begin_inset Formula $\emptyset$
\end_inset

 symbolizes here the number of tracks which didn't reach any of the A,B,C,D
 areas.
 For example by looking only the first row of each sub-table we easily observe
 that the crossing area was well represented by EITL, DSI and GQI but not
 from DTI as it was expected because the Single Tensor cannot resolve crossings.
 We can also observe by comparing all rows that in the more curved branch
 of the phantom less tracks reached their target that in the diagonal branch.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Tab:EuDX_AtoB"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
So, why is there always an amount of tracks which will not reach the other
 end-points? This happens because most of the area in high-dimensional volumes
 (3D volumes) is concentrated close to the boundaries of the volumes; therefore
 many from the random seeds will fall close to the boundaries.
 In addition, the boundaries are not smooth (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:eudx_fromABCD"

\end_inset

-left panel) and for this reason the tracks which will start close to the
 boundaries will most likely not travel long distances and because the number
 of seeds which will fall close to the boundaries is not negligible; the
 number of tracks which will not travel far is not negligible as well.
 This is something to have in mind when generating tractographies.
 A naive solution would be to increase the resolution of the volume by interpola
tion.
 This has disadvantages as well; the diffusion data sets are already very
 large and increasing the resolution would increase their already large
 size.
 Also interpolation usually introduces smoothing which will reduce the peak
 resolution in relation to high b-values where the signal is in general
 low.
 For this purpose we decided to not do any further preprocessing to the
 phantom.
\end_layout

\begin_layout Standard
Another general observation is that in the curved branch less tracks reached
 their target than in the diagonal branch.
 This is sensible because the discretization is more asymmetric in the curved
 branch (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:eudx_fromABCD"

\end_inset

-left panel) therefore more tracks close to the boundaries will stop propagating
 because they reach background voxels where anisotropy is much lower.
 This is in agreement with EuDX which is designed to stop in low anisotropic
 regions as defined by the parameter 
\begin_inset Formula $\mathcal{A}_{thr}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename last_figures/eudx_mask_tracks_sims.png
	lyxscale 30
	scale 60

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
On the left panel we see the b0 volume of the digital phantom and on top
 we see 
\begin_inset Formula $4$
\end_inset

 ROIs; A,B,C and D.
 
\begin_inset Formula $2000$
\end_inset

 seeds were generated inside each ROI and then we measured the amount of
 tracks which reached the other regions.
 On the right panel we see that when Single Tensor was used for the reconstructi
on; the tracking started from A reached only C.
 However when EITL was used the tracks reached both areas B and C as it
 was expected.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:eudx_fromABCD"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the right panel of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:eudx_fromABCD"

\end_inset

 we see that the tracks which started from ROI A, reached only ROI C when
 we used the peaks from the Single Tensor reconstruction method as input
 to EuDX.
 However when we used EITL the tracks which started from A, reached both
 B and C.
 The tracks didn't reach ROI D because of the angular threshold 
\begin_inset Formula $\theta_{thr}=60^{\circ}$
\end_inset

.
 This was another positive confirmation about the performance of EuDX which
 identified that even if the seeds are not in the crossing region because
 of the trilinear interpolation when the tracks will reach the crossing
 region they will follow the branch to which there are closer to in angular
 distance.
 
\end_layout

\begin_layout Subsection
Results with humans
\end_layout

\begin_layout Standard
We wanted to investigate how EuDX performed with healthy subjects.
 There are mainly two ways to do validate tractographies with real data.
 The first is to compare against the results of another tractography method
 and the second is to ask feedback from specialist medical practitioners
 who have good understanding of the underlying anatomy.
 We investigated first the second approach.
 In order to do that we generated tractographies (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:arcuate_and_whole_brain"

\end_inset

 (right panel)) and asked from expert neuroanatomists Professor Luigi Cataneo
 and Dr.
 Nivedita Agarwal from the Center for Brain/Mind Science (CiMeC) in Trento,
 Italy to validate the quality of the data in relationship to their knowledge
 from anatomy and manually label bundles of their scientific interest in
 different subjects.
 They manually found and labeled on first subject arcuate fasciculus (AC)
 which is depicted in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:arcuate_and_whole_brain"

\end_inset

 (left panel).
 They also identified in a different subject the right Corticospinal bundle
 depicted in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:cst_cst_bcc"

\end_inset

 (left panel).
 
\end_layout

\begin_layout Standard
In order to perform the manual labeling we developed an interactive visualizatio
n application (
\begin_inset ERT
status open

\begin_layout Plain Layout

fos.me
\end_layout

\end_inset

) based on a novel tractography clustering method which is the topic of
 the next chapter.
 This application has the capability to create an accessible representation
 of the initial tractography into bundles of interest (BOIs).
 Bundles means here a collection of tracks with similar spatial and shape
 characteristics.
 After the BOIs are created the medical practitioner can select one or more
 BOIs interactively and hide the other parts of the tractography which are
 not interesting to hers/his investigations.
 This application will not be the topic of this chapter but it is further
 explained in Chapter 5 (Section? XXXXX).
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "Frey2008"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "rilling2008evolution"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand cite
key "glasser2008dti"

\end_inset


\end_layout

\begin_layout Standard
The tractographies shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:arcuate_and_whole_brain"

\end_inset

 and left panel of Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:cst_cst_bcc"

\end_inset

 were calculated with EuDX parameters 
\begin_inset Formula $\mathcal{A}_{thr}=0.02$
\end_inset

,
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
Delta s=0.5$
\end_layout

\end_inset

, 
\begin_inset Formula $\theta_{thr}=60^{\circ}$
\end_inset

, 
\begin_inset Formula $TW=0.5$
\end_inset

 and with input from QA of GQI reconstruction with sampling length 
\begin_inset Formula $\lambda=1.2$
\end_inset

.
 The data sets were generated at a 3T scanner (TIM Trio, Siemens) in Medical
 Research Council Cognition and Brain Sciences Unit, Cambridge, UK.
 We used Siemens advanced diffusion work-in-progress sequence, and STEAM
 
\begin_inset CommandInset citation
LatexCommand cite
key "merboldt1992diffusion,MAB04"

\end_inset

 as the diffusion preparation method.
 The field of view was 
\begin_inset Formula $240x240mm^{2}$
\end_inset

, matrix size 
\begin_inset Formula $96x96$
\end_inset

, and slice thickness 
\begin_inset Formula $2.5mm$
\end_inset

 (no gap).
 
\begin_inset Formula $55$
\end_inset

 slices were acquired to achieve full brain coverage, and the voxel resolution
 was 
\begin_inset Formula $2.5x2.5x2.5mm{}^{3}$
\end_inset

.
 In this experiment much less gradient vectors were used.
 A 
\begin_inset Formula $102$
\end_inset

-point half grid acquisition with a maximum b-value of 
\begin_inset Formula $4000\, s/mm^{2}$
\end_inset

 was used.
 The total acquisition time was only 
\begin_inset Formula $14\, min\,21s$
\end_inset

 with TR=
\begin_inset Formula $8200ms$
\end_inset

 and TE=
\begin_inset Formula $69ms$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename eudx_last/subj5_double.png
	lyxscale 30
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Left Panel: right arcuate fasciculus generated by EuDX and segmented by
 two expert neuroanatomists.
 The tracks are in MNI coordinates and we visualize simultaneously the T1
 slice (X=
\begin_inset Formula $29$
\end_inset

) 
\begin_inset Note Note
status open

\begin_layout Plain Layout
subject 5
\end_layout

\end_inset

 for the same subject.
 Right Panel: the sagittal view of the whole brain tractography of the same
 subject is shown.
 For visualization purposes we are depicting only tracks of length from
 
\begin_inset Formula $120$
\end_inset

mm to 
\begin_inset Formula $150$
\end_inset

mm.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:arcuate_and_whole_brain"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The tractographies were generated in diffusion native space and then linearly
 registered in For that reason FA volumes were generated from the same data
 sets using Tensor fitting with weighted least squares after skull stripping
 with FSL BET.
 These FA volumes were again in diffusion native space therefore we used
 FSL FLIRT to align them in MNI space.
 For this purpose a standard template (
\begin_inset Formula $\texttt{FMRIB58\_FA\_1mm}$
\end_inset

) from the FSL toolbox was used as the reference volume.
 We then applied the affine transformation matrix from the previous step
 to the initial tractography to align it to MNI space.
 
\end_layout

\begin_layout Standard
In order to help the neuroanatomists to guide themselves with the segmentation
 of bundles we linearly registered structural MRIs - T1 (MPRAGE) images
 from the same subjects to the standard template (
\begin_inset Formula $\texttt{MNI152\_T1\_1mm\_brain}$
\end_inset

).
 Therefore, the tractography and the T1 image were properly aligned in the
 same space.
 This was very useful for the neuroanatomists because they could find known
 bundles from the regions they connect in the cortex which are better visible
 in the T1 rather than in FA.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename eudx_last/Subj1_cst_cc_cross.png
	lyxscale 20
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Left panel: EuDX tracks from the CST segmented by our expert neuroanatomists.
 The tracks are linearly registered in MNI standard space and visible is
 also the T1 slice (Y=
\begin_inset Formula $5$
\end_inset

) from the same subject.
 Right panel: Here we see the intersection of the BCC with the right CST.
 This is a confirmation that EuDX can propagate successfully in crossing
 areas of human brain data.
 The T1 slice (Y=
\begin_inset Formula $-1$
\end_inset

) from the same subject is shown.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:cst_cst_bcc"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the previous section we observed from our simulation experiments that
 EuDX was able to propagate correctly in crossing areas (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:crossing_eudx_sims"

\end_inset

) by generating tracks towards both directions of the crossings.
 We wanted to confirm if tracking in crossing areas was also robust with
 human data where the noise artefacts are less predictable.
 This was indeed confirmed by looking at the intersection of two well known
 bundles: the Body of Corpus Callosum (BCC) and the Corticospinal Tract
 (CST).
 In Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:cst_cst_bcc"

\end_inset

 (right panel) we can see that a part from the BCC shown with red is intersectin
g the CST bundle shown with blue without being diverted from the CST.
 If EuDX was not able to propagate in crossing areas then the tracks from
 BCC would stop in the intersection area or divert towards the direction
 of the CST.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename eudx_last/12_subjects_cingulum.png
	lyxscale 20
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The left and right Cingulum (CG) bundles of 
\begin_inset Formula $12$
\end_inset

 healthy subjects are presented here.
 CGs were selected in MNI space from entire EuDX tractophies of 1 million
 seeds and GQI with sampling length 
\begin_inset Formula $\lambda=1.2$
\end_inset

.
 We also show the T1 image slice Z=
\begin_inset Formula $10$
\end_inset

 for every subject except from last subject whos T1 was not available.
 For that subject we use the standard MNI template.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "Flo:cingulum_12_subjects"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We wanted also to compare specific bundles across different healthy subjects.
 We concentrated at an one not so often studied bundle: the Cingulum; across
 
\begin_inset Formula $12$
\end_inset

 subjects.
\end_layout

\begin_layout Standard
The cingulum (CG) is an association fibre tract that runs within the cingulate
 gyrus along its entire length.
 It collects axons from the cingulate gyrus that travel immediately dorsal
 to the corpus callosum and along the ventral face of the hippocampus, forming
 a large C-shape trajectory.
 It carries afferent connections from the cingulate gyrus to the entorhinal
 cortex.
 Because of its narrow tubular shape, it is often difficult to reveal its
 entire length by a single data set 
\begin_inset CommandInset citation
LatexCommand cite
key "moriBook"

\end_inset

.
 However, using EuDX we see that both left and right CG bundles were consistent
 across all 
\begin_inset Formula $12$
\end_inset

 subjects (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:cingulum_12_subjects"

\end_inset

).
 In this atlas, the cingulum was selected using the visualization tool described
 before from the entire tractography generated with 
\begin_inset Formula $1$
\end_inset

 million seeds.
 The reconstruction parameters and EuDX parameters were the same as before
 with the exception of the number of initial seeds.
 Furthermore the tractographies of all subjects were registered together
 with the structural imagines in MNI space.
 The only exeception was with last subject 
\begin_inset Formula $12$
\end_inset

 whos T1 image was not available and it was visualized together with the
 MNI standard template (
\begin_inset Formula $\texttt{MNI152\_T1\_1mm\_brain}$
\end_inset

) (see bottom-right corner of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "Flo:cingulum_12_subjects"

\end_inset

).
\end_layout

\begin_layout Standard
SLF PROBTRACKX VERSUS EUDX - Try to use with all 
\begin_inset Formula $3$
\end_inset

 EITL, DSI and GQI.
\end_layout

\begin_layout Standard
ADD Timing experiment.
\end_layout

\begin_layout Standard
XXXXX
\end_layout

\begin_layout Subsection
Conclusion
\end_layout

\begin_layout Standard
We showed that EuDX is a fast deterministic tractography method which can
 be used to propagate in crossing and non-crossing areas in simulations
 and human brain data sets.
 
\end_layout

\begin_layout Standard
With the help of expert neuroanatomists we confirmed that EuDX can be used
 to find bundles witch are known from anatomy like AC, CST and we investigated
 how CG looked between different subjects.
\end_layout

\begin_layout Standard
Currently the neuroanatomists are continuing segmenting more and more labels
 and we hope that in the near future we will have a large collection of
 segmented bundles which could be used to create better tractography algorithms
 by understanding better the underlying data sets or exploit supervised
 learning techniques in order to find the same bundles in other subjects.
\end_layout

\begin_layout Standard
The purpose of EuDX is to be faithful to the reconstruction results rather
 than try to correct or enhance them by introducing regional or global considera
tions which is the topic of other methods which were reviewed earlier.
 Therefore, EuDX serves mainly as a robust method for quickly inspecting
 different reconstruction results using streamlines.
 
\end_layout

\begin_layout Standard
EuDX is will stop tracking on voxel with low anisotropy and will not take
 into consideration other voxels after it as it would happen with other
 probabilistic techniques.
 This property is often useful when validating underlying reconstruction
 models.
 
\end_layout

\begin_layout Standard
Furthermore we showed that EuDX can take as input many different anisotropic
 functions e.g.
 FA, QA, PK etc.
 and therefore it has no restrictions for the underlying model neither to
 the number of peaks per voxel.
\end_layout

\begin_layout Standard
The source code for EuDX can be found in dipy.tracking.eudx which is available
 at dipy.org
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Reference abbreviations: 
\end_layout

\begin_layout Plain Layout
search for: bibtex style abbreviate
\end_layout

\begin_layout Plain Layout
ieeetr (selected)
\end_layout

\begin_layout Plain Layout
acm
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard

\lang british
\begin_inset Note Note
status open

\begin_layout Plain Layout

\lang british
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "diffusion"
options "ieeetr"

\end_inset


\end_layout

\end_inset


\end_layout

\end_body
\end_document
